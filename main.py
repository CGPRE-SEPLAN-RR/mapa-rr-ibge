import folium
import geopandas as gpd
import matplotlib.pyplot as plt
import matplotlib.patches as patches

sectors_per_neighbourhood = {
    "13 DE SETEMBRO": [
        "140010005000021P",
        "140010005000022P",
        "140010005000023P",
        "140010005000024P",
        "140010005000025P",
        "140010005000026P",
        "140010005000542P",
        "140010005000543P",
        "140010005000544P",
        "140010005000545P",
        "140010005000554P",
        "140010005000561P",
    ],
    "31 DE MARCO": [
        "140010005000115P",
        "140010005000116P",
        "140010005000360P",
    ],
    "AEROPORTO": [
		"140010005000098P",
		"140010005000104P",
		"140010005000263P",
		"140010005000264P",
		"140010005000265P",
		"140010005000359P",
		"140010005000392P",
		"140010005000439P",
		"140010005000038P",
    ],
    "ALVORADA": [
		"140010005000176P",
		"140010005000198P",
		"140010005000208P",
		"140010005000209P",
		"140010005000280P",
		"140010005000283P",
		"140010005000299P",
		"140010005000300P",
		"140010005000394P",
		"140010005000397P",
    ],
"ASA BRANCA": ["140010005000080P",
		"140010005000081P",
		"140010005000082P",
		"140010005000083P",
		"140010005000084P",
		"140010005000085P",
		"140010005000086P",
		"140010005000087P",
		"140010005000088P",
		"140010005000125P",
		"140010005000126P",
		"140010005000127P",
		"140010005000128P",
		"140010005000358P",
		"140010005000363P",
               ],
"BELA VISTA": ["140010005000250P",
		"140010005000251P",
		"140010005000252P",
		"140010005000253P",
		"140010005000313P",
		"140010005000314P",
               ],
"BURITIS": ["140010005000076P",
		"140010005000077P",
		"140010005000078P",
		"140010005000079P",
		"140010005000123P",
		"140010005000124P",
		"140010005000137P",
		"140010005000138P",
		"140010005000145P",
		"140010005000146P",
		"140010005000147P",
		"140010005000148P",
		"140010005000149P",
		"140010005000150P",
            ],
"CACARI": ["140010005000043P",
		"140010005000044P",
		"140010005000045P",
		"140010005000261P",
		"140010005000391P",
"140010005000356P",
           ],
"CAIMBE": ["140010005000129P",
		"140010005000131P",
		"140010005000132P",
		"140010005000133P",
		"140010005000134P",
		"140010005000135P",
		"140010005000136P",
		"140010005000364P",
		"140010005000365P",
		"140010005000535P",
		"140010005000536P",
           ],
"CALUNGA": ["140010005000015P",
		"140010005000016P",
		"140010005000351P",
            ],
"CAMBARA": ["140010005000151P",
		"140010005000152P",
		"140010005000153P",
		"140010005000154P",
		"140010005000155P",
		"140010005000271P",
		"140010005000366P",
		"140010005000367P",
		"140010005000368P",
		"140010005000537P",
            ],
"CANARINHO": ["140010005000157P"],
"CARANA": ["140010005000029P",
		"140010005000031P",
		"140010005000033P",
		"140010005000035P",
		"140010005000230P",
		"140010005000231P",
		"140010005000311P",
		"140010005000321P",
		"140010005000352P",
		"140010005000424P",
		"140010005000522P",
		"140010005000523P",
		"140010005000524P",
		"140010005000525P",
           ],
"CAUAME": ["140010005000234P",
		"140010005000235P",
		"140010005000236P",
		"140010005000237P",
		"140010005000239P",
		"140010005000385P",
		"140010005000386P",
		"140010005000520P",
		"140010005000521P",
           ],
"CENTENARIO": ["140010005000028P",
		"140010005000324P",
		"140010005000325P",
		"140010005000326P",
		"140010005000327P",
		"140010005000329P",
		"140010005000420P",
		"140010005000482P",
		"140010005000483P",
               ],
"CENTRO": ["140010005000001P",
		"140010005000002P",
		"140010005000003P",
		"140010005000004P",
		"140010005000005P",
		"140010005000007P",
		"140010005000008P",
		"140010005000009P",
		"140010005000010P",
		"140010005000011P",
		"140010005000012P",
		"140010005000013P",
		"140010005000014P",
		"140010005000350P",
		"140010005000518P",
		"140010005000519P",
           ],
"CIDADE SATELITE": ["140010005000319P",
		"140010005000320P",
		"140010005000405P",
		"140010005000406P",
		"140010005000427P",
		"140010005000428P",
		"140010005000429P",
		"140010005000430P",
		"140010005000432P",
		"140010005000433P",
		"140010005000459P",
		"140010005000460P",
		"140010005000462P",
		"140010005000463P",
		"140010005000464P",
		"140010005000465P",
		"140010005000466P",
		"140010005000467P",
		"140010005000468P",
		"140010005000469P",
		"140010005000470P",
		"140010005000472P",
		"140010005000473P",
		"140010005000507P",
		"140010005000526P",
		"140010005000527P",
		"140010005000528P",
		"140010005000529P",
		"140010005000555P",
		"140010005000556P",
		"140010005000559P",
		"140010005000560P",
                    ],
"CINTURAO VERDE": ["140010005000224P",
		"140010005000225P",
		"140010005000226P",
		"140010005000380P",
		"140010005000381P",
		"140010005000382P",
		"140010005000426P",
                   ],
"DISTRITO INDUSTRIAL": ["140010005000471P",
		"140010005000502P",
		"140010005000503P",
                        ],
"DOS ESTADOS": ["140010005000105P",
		"140010005000107P",
		"140010005000108P",
		"140010005000109P",
		"140010005000110P",
		"140010005000480P",
		"140010005000481P",
                ],
"DOUTOR AIRTON ROCHA": ["140010005000255P",
		"140010005000451P",
		"140010005000452P",
		"140010005000453P",
		"140010005000454P",
		"140010005000455P",
		"140010005000456P",
		"140010005000457P",
		"140010005000458P",
                        ],
"DOUTOR SILVIO BOTELHO": ["140010005000165P",
		"140010005000166P",
		"140010005000167P",
		"140010005000168P",
		"140010005000269P",
		"140010005000287P",
		"140010005000293P",
		"140010005000294P",
		"140010005000539P",
		"140010005000540P",
                          ],
"DOUTOR SILVIO LEITE": ["140010005000202P",
		"140010005000203P",
		"140010005000204P",
		"140010005000205P",
		"140010005000206P",
		"140010005000207P",
		"140010005000302P",
		"140010005000377P",
		"140010005000398P",
                        ],
"EQUATORIAL": ["140010005000183P",
		"140010005000199P",
		"140010005000200P",
		"140010005000201P",
		"140010005000298P",
		"140010005000301P",
		"140010005000372P",
		"140010005000376P",
		"140010005000421P",
		"140010005000422P",
		"140010005000423P",
               ],
"JARDIM CARANA": ["140010005000036P",
		"140010005000037P",
		"140010005000232P",
		"140010005000233P",
		"140010005000259P",
                  ],
"JARDIM FLORESTA": ["140010005000100P",
		"140010005000101P",
		"140010005000102P",
		"140010005000103P",
		"140010005000262P",
		"140010005000516P",
		"140010005000517P",
                    ],
"JARDIM PRIMAVERA": ["140010005000212P",
		"140010005000214P",
		"140010005000218P",
		"140010005000219P",
		"140010005000220P",
		"140010005000222P",
		"140010005000306P",
		"140010005000308P",
		"140010005000309P",
		"140010005000378P",
		"140010005000379P",
                     ],
"JARDIM TROPICAL": ["140010005000169P",
		"140010005000493P",
		"140010005000494P",
		"140010005000495P",
		"140010005000496P",
		"140010005000500P",
		"140010005000501P",
                    ],
"JOQUEI CLUBE": ["140010005000163P",
		"140010005000227P",
		"140010005000228P",
		"140010005000229P",
		"140010005000257P",
		"140010005000310P",
		"140010005000384P",
		"140010005000390P",
		"140010005000530P",
		"140010005000531P",
		"140010005000557P",
		"140010005000558P",
                 ],
"LAURA MOREIRA": ["140010005000286P",
		"140010005000291P",
		"140010005000292P",
		"140010005000297P",
		"140010005000407P",
		"140010005000425P",
		"140010005000548P",
		"140010005000550P",
                  ],
"LIBERDADE": ["140010005000120P",
		"140010005000121P",
		"140010005000139P",
		"140010005000140P",
		"140010005000141P",
		"140010005000142P",
		"140010005000143P",
		"140010005000144P",
		"140010005000242P",
		"140010005000243P",
              ],
"MARECHAL RONDON": ["140010005000027P"],
"MECEJANA": ["140010005000055P",
		"140010005000056P",
		"140010005000057P",
		"140010005000058P",
		"140010005000059P",
		"140010005000060P",
		"140010005000061P",
		"140010005000117P",
		"140010005000118P",
		"140010005000119P",
		"140010005000361P",
             ],
"MONTE CRISTO": ["140010005000409P", "140010005000349P", "140010005000552P"],
"MURILO TEIXEIRA CIDADE": ["140010005000317P",
		"140010005000549P",
                           ],
"NOSSA SENHORA APARECIDA": ["140010005000111P",
		"140010005000112P",
		"140010005000113P",
		"140010005000114P",
		"140010005000240P",
		"140010005000241P",
		"140010005000387P",
                            ],
"NOVA CANAA": ["140010005000172P",
		"140010005000173P",
		"140010005000275P",
		"140010005000279P",
		"140010005000538P",
               ],
"NOVA CIDADE": ["140010005000254P",
		"140010005000315P",
		"140010005000388P",
		"140010005000389P",
		"140010005000403P",
                ],
"OLIMPICO": ["140010005000270P"],
"OPERARIO": ["140010005000369P",
		"140010005000504P",
		"140010005000505P",
		"140010005000508P",
		"140010005000509P",
		"140010005000510P",
		"140010005000511P",
             ],
"PARAVIANA": ["140010005000039P",
		"140010005000040P",
		"140010005000042P",
		"140010005000323P",
		"140010005000354P",
		"140010005000355P",
		"140010005000399P",
		"140010005000488P",
		"140010005000489P",
              ],
"PEDRA PINTADA": ["140010005000477P",
		"140010005000478P",
		"140010005000479P",
		"140010005000450P",
                  ],
"PINTOLANDIA": ["140010005000174P",
		"140010005000175P",
		"140010005000177P",
		"140010005000186P",
		"140010005000187P",
		"140010005000188P",
		"140010005000274P",
		"140010005000276P",
		"140010005000277P",
		"140010005000278P",
		"140010005000281P",
		"140010005000282P",
		"140010005000289P",
		"140010005000370P",
		"140010005000393P",
                ],
"PISCICULTURA": ["140010005000223P",
		"140010005000307P",
		"140010005000553P",
                 ],
"PRICUMA": ["140010005000068P",
		"140010005000069P",
		"140010005000070P",
		"140010005000071P",
		"140010005000072P",
		"140010005000073P",
		"140010005000074P",
		"140010005000075P",
		"140010005000122P",
		"140010005000362P",
            ],
"PROFESSORA ARACELI SOUTO MAIOR": ["140010005000158P",
		"140010005000330P",
		"140010005000331P",
		"140010005000332P",
		"140010005000335P",
		"140010005000490P",
                                   ],
"RAIAR DO SOL": ["140010005000159P",
		"140010005000160P",
		"140010005000246P",
		"140010005000247P",
		"140010005000248P",
		"140010005000249P",
		"140010005000267P",
		"140010005000312P",
                 ],
"SAID SALOMAO": ["140010005000431P"],
"SANTA LUZIA": ["140010005000178P",
		"140010005000179P",
		"140010005000180P",
		"140010005000181P",
		"140010005000182P",
		"140010005000184P",
		"140010005000285P",
		"140010005000371P",
                ],
"SANTA TEREZA": ["140010005000210P",
		"140010005000211P",
		"140010005000213P",
		"140010005000215P",
		"140010005000216P",
		"140010005000217P",
		"140010005000221P",
		"140010005000266P",
		"140010005000304P",
		"140010005000514P",
		"140010005000515P",
                 ],
"SAO BENTO": ["140010005000322P",
		"140010005000333P",
		"140010005000334P",
		"140010005000336P",
		"140010005000337P",
		"140010005000401P",
		"140010005000402P",
		"140010005000404P",
		"140010005000491P",
		"140010005000492P",
              ],
"SAO FRANCISCO": ["140010005000048P",
		"140010005000049P",
		"140010005000050P",
		"140010005000051P",
		"140010005000052P",
		"140010005000053P",
		"140010005000054P",
		"140010005000357P",
                  ],
"SAO PEDRO": ["140010005000046P",
		"140010005000047P",
              ],
"SAO VICENTE": ["140010005000018P",
		"140010005000019P",
		"140010005000020P",
		"140010005000062P",
		"140010005000063P",
		"140010005000064P",
		"140010005000066P",
		"140010005000067P",
		"140010005000256P",
		"140010005000512P",
		"140010005000546P",
		"140010005000547P",
		"140010005000513P",
                ],
"SENADOR HELIO CAMPOS": ["140010005000185P",
		"140010005000189P",
		"140010005000190P",
		"140010005000191P",
		"140010005000192P",
		"140010005000194P",
		"140010005000195P",
		"140010005000196P",
		"140010005000197P",
		"140010005000272P",
		"140010005000273P",
		"140010005000284P",
		"140010005000288P",
		"140010005000290P",
		"140010005000295P",
		"140010005000296P",
		"140010005000373P",
		"140010005000374P",
		"140010005000375P",
		"140010005000383P",
		"140010005000395P",
		"140010005000396P",
		"140010005000400P",
		"140010005000497P",
		"140010005000498P",
		"140010005000499P",
                         ],
"TANCREDO NEVES": ["140010005000089P",
		"140010005000090P",
		"140010005000091P",
		"140010005000092P",
		"140010005000093P",
		"140010005000094P",
		"140010005000095P",
		"140010005000096P",
		"140010005000097P",
                   ],
"UNIAO": ["140010005000032P",
		"140010005000258P",
		"140010005000260P",
		"140010005000353P",
          ],
}

codes_to_delete = [
    "140010005000348P",
    "140010005000345P,",
    "140010005000342P",
    "140010005000410P",
    "140010005000411P",
    "140010005000412P",
    "140010005000413P",
    "140010005000414P",
    "140010005000415P",
    "140010005000416P",
    "140010005000417P",
    "140010005000434P",
    "140010005000435P",
    "140010005000436P",
    "140010005000437P",
    "140010005000438P",
    "140010005000484P",
    "140010005000485P",
    "140010005000486P",
    "140010005000461P",
    "140010005000532P",
    "140010005000533P",
    "140010005000534P",
    "140010005000341P",
    "140010005000441P",
    "140010005000442P",
    "140010005000447P",
    "140010005000448P",
    "140010005000343P",
    "140010005000444P",
    "140010005000446P",
    "140010005000340P",
    "140010005000445P",
    "140010005000551P",
    "140010005000487P",
    "140010005000344P",
    "140010005000443P",
    "140010005000347P",
    "140010005000345P",
    "140010005000409P",
    "140010005000338P",
]

shape = gpd.read_file("data/RR_Malha_Preliminar_2022.shp")
shape = shape[shape["NM_MUN"] == "Boa Vista"]
shape = shape[["CD_SETOR", "v0001", "geometry"]]
shape = shape[~shape["CD_SETOR"].isin(codes_to_delete)]
shape.insert(0, "BAIRRO", [None for _ in range(len(shape.index))], True)

for i, row in shape.iterrows():
		for neighbourhood, codes in sectors_per_neighbourhood.items(): 
				if row["CD_SETOR"] in codes:
						shape.at[i, "BAIRRO"] = neighbourhood
						break
shape = shape.drop(columns=["CD_SETOR"])
shape = shape.dissolve(by="BAIRRO", aggfunc=["sum"])
shape = shape.rename(columns={("v0001", "sum"): "POPULACAO"})
output = shape.explore(column="POPULACAO", scheme="naturalbreaks", k=10, legend=True, legend_kwds=dict(colorbar=False), name="População por Bairro", tiles=None)
output.save("interactive.html")
# shape.plot(column="POPULACAO", legend=True)
# plt.show()
# plt.savefig("output.svg")
